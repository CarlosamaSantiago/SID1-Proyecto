-- Creación Base De Datos del Gymnasio
-- DDL
SET SERVEROUTPUT ON
-- Eliminar tablas en orden inverso a su creación (primero las más dependientes)
DROP TABLE ACTIVACIONES_MENSUALES;
DROP TABLE ASISTENCIAS;
DROP TABLE MANTENIMIENTOS;
DROP TABLE EVALUACIONES_FISICAS;
DROP TABLE PRODUCTOS_VENDIDOS;
DROP TABLE PRODUCTOS_SURTIDOS;
DROP TABLE CONTRATOS;
DROP TABLE PAGOS_MEMBRESIA;
DROP TABLE VENTAS;
DROP TABLE PEDIDOS;
DROP TABLE IMPLEMENTOS;
DROP TABLE PLANES_ENTRENAMIENTO;
DROP TABLE RECEPCIONISTAS;
DROP TABLE TECNICOS;
DROP TABLE ENTRENADORES;
DROP TABLE PRODUCTOS;
DROP TABLE PROVEEDORES;
DROP TABLE CLIENTES CASCADE CONSTRAINTS;
DROP TABLE HORARIOS_RECEPCIONISTAS;

CREATE TABLE HORARIOS_RECEPCIONISTAS(
    idHorario VARCHAR2(10 CHAR) NOT NULL,
    horaInicio VARCHAR2(5 CHAR) NOT NULL,
    horaFinal VARCHAR2(5 CHAR) NOT NULL
);

ALTER TABLE HORARIOS_RECEPCIONISTAS
    ADD CONSTRAINT HORARIOS_RECEPCIONISTAS_PK PRIMARY KEY (idHorario);

-- Crear tabla CLIENTES
CREATE TABLE CLIENTES (
    idCliente VARCHAR2(10 CHAR) NOT NULL,
    nombreCliente VARCHAR2(30 CHAR) NOT NULL,
    telefonoCliente VARCHAR2(10 CHAR) NOT NULL,
    correoCliente VARCHAR2(30 CHAR) NOT NULL,
    sexoCliente VARCHAR2(9 CHAR) NOT NULL
);

ALTER TABLE CLIENTES
    ADD CONSTRAINT CLIENTE_PK PRIMARY KEY (idCliente);
ALTER TABLE CLIENTES
ADD CONSTRAINT chk_genero CHECK (sexoCliente IN ('MASCULINO', 'FEMENINO'));


-- Crear tabla PROVEEDORES
CREATE TABLE PROVEEDORES (
    idProveedor VARCHAR2(10 CHAR) NOT NULL,
    condicionesDePago VARCHAR2(30 CHAR) NOT NULL,
    telefonoProveedor VARCHAR2(30 CHAR) NOT NULL,
    correoProveedor VARCHAR2(30 CHAR) NOT NULL
);

ALTER TABLE PROVEEDORES
    ADD CONSTRAINT PROVEEDOR_PK PRIMARY KEY (idProveedor);

-- Crear tabla PRODUCTOS
CREATE TABLE PRODUCTOS (
    idProducto VARCHAR2(10) NOT NULL,
    precioProducto NUMBER NOT NULL,
    nombreProducto VARCHAR2(20 CHAR) NOT NULL,
    stock INTEGER NOT NULL,
    marcaProducto VARCHAR2(10),
    descripcionProducto VARCHAR2(10)
);

ALTER TABLE PRODUCTOS
    ADD CONSTRAINT PRODUCTO_PK PRIMARY KEY (idProducto);

-- Crear tabla RECEPCIONISTAS
CREATE TABLE RECEPCIONISTAS (
    idRecepcionista VARCHAR2(10 CHAR) NOT NULL,
    nombreRecepcionista VARCHAR2(30 CHAR) NOT NULL,
    horarioTrabajo VARCHAR2(10 CHAR) NOT NULL,
    salario INTEGER NOT NULL
);

ALTER TABLE RECEPCIONISTAS
    ADD CONSTRAINT RECEPCIONISTA_PK PRIMARY KEY (idRecepcionista);
ALTER TABLE RECEPCIONISTAS
    ADD CONSTRAINT HORARIO_TRABAJO_FK FOREIGN KEY (horarioTrabajo)
        REFERENCES HORARIOS_RECEPCIONISTAS (idHorario);
    
-- Crear tabla ENTRENADORES
CREATE TABLE ENTRENADORES (
    idEntrenador VARCHAR2(10 CHAR) NOT NULL,
    nombreEntrenador VARCHAR2(30 CHAR) NOT NULL,
    reputacion INTEGER NOT NULL,
    costoHora NUMBER NOT NULL
);

ALTER TABLE ENTRENADORES
    ADD CONSTRAINT ENTRENADOR_PK PRIMARY KEY (idEntrenador);

-- Crear tabla TECNICOS
CREATE TABLE TECNICOS (
    idTecnico VARCHAR2(10 CHAR) NOT NULL,
    nombreTecnico VARCHAR2(10 CHAR) NOT NULL,
    costoHora NUMBER NOT NULL,
    tituloAcademico VARCHAR2(100 CHAR) NOT NULL,
    telefonoTecnico VARCHAR2(10 CHAR) NOT NULL
);

ALTER TABLE TECNICOS
    ADD CONSTRAINT TECNICO_PK PRIMARY KEY (idTecnico);
    
-- Crear tabla PLANES_ENTRENAMIENTO
CREATE TABLE PLANES_ENTRENAMIENTO (
    idPlan VARCHAR2(10 CHAR) NOT NULL ,
    objetivoPlan VARCHAR2(100 CHAR) NOT NULL,
    duracionPlan INTEGER NOT NULL,
    costoPlan NUMBER NOT NULL,
    observaciones VARCHAR2(100 CHAR)NOT NULL 
);

ALTER TABLE PLANES_ENTRENAMIENTO
    ADD CONSTRAINT PLAN_ENTRENAMIENTO_PK PRIMARY KEY (idPlan);
    
-- Crear tabla IMPLEMENTOS
CREATE TABLE IMPLEMENTOS (
    idImplemento VARCHAR2(10 CHAR) NOT NULL,
    nombreImplemento VARCHAR2(20) NOT NULL,
    inicioServicio DATE NOT NULL,
    finServicio DATE 
);

ALTER TABLE IMPLEMENTOS
    ADD CONSTRAINT IMPLEMENTO_PK PRIMARY KEY (idImplemento);
    
-- Crear tabla PEDIDOS
CREATE TABLE PEDIDOS (
    idPedido VARCHAR2(10 CHAR) NOT NULL,
    fechaDePetición DATE NOT NULL,
    estadoPedido VARCHAR2(10 CHAR) NOT NULL,
    fechaEntrega DATE ,
    idProveedor VARCHAR2(10 CHAR)NOT NULL
);

ALTER TABLE PEDIDOS
    ADD CONSTRAINT PEDIDO_PK PRIMARY KEY (idPedido);

ALTER TABLE PEDIDOS
    ADD CONSTRAINT PEDIDO_PROVEEDOR_FK FOREIGN KEY (idProveedor)
        REFERENCES PROVEEDORES (idProveedor);
ALTER TABLE PEDIDOS
ADD CONSTRAINT chk_estadoPedido CHECK (estadoPedido IN ('SOLICITADO', 'EN CAMINO', 'RECIBIDO'));

        
-- Crear tabla VENTAS
CREATE TABLE VENTAS (
    idVenta VARCHAR2(10 CHAR) NOT NULL,
    fechaVenta DATE NOT NULL,
    idCliente VARCHAR2(10 CHAR) NOT NULL,
    idRecepcionista VARCHAR2(10 CHAR) NOT NULL
);

ALTER TABLE VENTAS
    ADD CONSTRAINT VENTA_PK PRIMARY KEY (idVenta);

ALTER TABLE VENTAS
    ADD CONSTRAINT VENTA_CLIENTE_FK FOREIGN KEY (idCliente)
        REFERENCES CLIENTES (idCliente);

ALTER TABLE VENTAS
    ADD CONSTRAINT VENTA_RECEPCIONISTA_FK FOREIGN KEY (idRecepcionista)
        REFERENCES RECEPCIONISTAS (idRecepcionista);
        
-- Crear tabla PAGOS_MEMBRESIA
CREATE TABLE PAGOS_MEMBRESIA (
    idPago VARCHAR2(10 CHAR) NOT NULL,
    fechaPago DATE NOT NULL, 
    valorPago NUMBER NOT NULL,
    estadoPago VARCHAR2(10 CHAR)NOT NULL,
    metodoPago VARCHAR2(10 CHAR)NOT NULL
);

ALTER TABLE PAGOS_MEMBRESIA
    ADD CONSTRAINT PAGO_MEMBRESIA_PK PRIMARY KEY (idPago);
    
-- Crear tabla CONTRATOS
CREATE TABLE CONTRATOS (
    idContrato VARCHAR2(10) NOT NULL,
    fechaInicio DATE NOT NULL, 
    fechaCierre DATE NOT NULL,
    idCliente VARCHAR2(10 CHAR) NOT NULL,
    idPlan VARCHAR2(10 CHAR) NOT NULL
);

ALTER TABLE CONTRATOS
    ADD CONSTRAINT CONTRATO_PK PRIMARY KEY (idContrato);

ALTER TABLE CONTRATOS
    ADD CONSTRAINT CONTRATO_CLIENTE_FK FOREIGN KEY (idCliente)
        REFERENCES CLIENTES (idCliente);

ALTER TABLE CONTRATOS
    ADD CONSTRAINT CONTRATO_PLAN_ENTRENAMIENTO_FK FOREIGN KEY (idPlan)
        REFERENCES PLANES_ENTRENAMIENTO (idPlan);
        
-- Crear tabla PRODUCTOS_SURTIDOS
CREATE TABLE PRODUCTOS_SURTIDOS (
    idSurtidos VARCHAR2(10) NOT NULL,
    cantidadProducto INTEGER NOT NULL,
    idProducto VARCHAR2(10) NOT NULL,
    idPedido VARCHAR2(10 CHAR)NOT NULL
);

ALTER TABLE PRODUCTOS_SURTIDOS
    ADD CONSTRAINT PRODUCTO_SURTIDO_PK PRIMARY KEY (idSurtidos);

ALTER TABLE PRODUCTOS_SURTIDOS
    ADD CONSTRAINT PRODUCTO_SURTIDO_PRODUCTO_FK FOREIGN KEY (idProducto)
        REFERENCES PRODUCTOS (idProducto);

ALTER TABLE PRODUCTOS_SURTIDOS
    ADD CONSTRAINT PRODUCTO_SURTIDO_PEDIDO_FK FOREIGN KEY (idPedido)
        REFERENCES PEDIDOS (idPedido);

-- Crear tabla PRODUCTOS_VENDIDOS
CREATE TABLE PRODUCTOS_VENDIDOS (
    idVendidos VARCHAR2(10) NOT NULL,
    idVenta VARCHAR2(10 CHAR) NOT NULL,
    cantidadTotal INTEGER NOT NULL,
    idProducto VARCHAR2(10) NOT NULL
);

ALTER TABLE PRODUCTOS_VENDIDOS
    ADD CONSTRAINT PRODUCTO_VENDIDO_PK PRIMARY KEY (idVendidos);

ALTER TABLE PRODUCTOS_VENDIDOS
    ADD CONSTRAINT PRODUCTO_VENDIDO_VENTA_FK FOREIGN KEY (idVenta)
        REFERENCES VENTAS (idVenta);

ALTER TABLE PRODUCTOS_VENDIDOS
    ADD CONSTRAINT PRODUCTO_VENDIDO_PRODUCTO_FK FOREIGN KEY (idProducto)
        REFERENCES PRODUCTOS (idProducto);
        
-- Crear tabla EVALUACIONES_FISICAS
CREATE TABLE EVALUACIONES_FISICAS (
    idEvaluación VARCHAR2(10 CHAR) NOT NULL,
    fechaEvaluacion DATE NOT NULL,
    peso FLOAT NOT NULL,
    estatura NUMBER NOT NULL,
    IMC FLOAT NOT NULL,
    porcentajeGrasa FLOAT ,
    observaciones VARCHAR2(100),
    idCliente VARCHAR2(10 CHAR) NOT NULL,
    idEntrenador VARCHAR2(10 CHAR) NOT NULL
);

ALTER TABLE EVALUACIONES_FISICAS
    ADD CONSTRAINT EVALUACION_FISICA_PK PRIMARY KEY (idEvaluación);

ALTER TABLE EVALUACIONES_FISICAS
    ADD CONSTRAINT EVALUACION_FISICA_CLIENTE_FK FOREIGN KEY (idCliente)
        REFERENCES CLIENTES (idCliente);

ALTER TABLE EVALUACIONES_FISICAS
    ADD CONSTRAINT EVALUACION_FISICA_ENTRENADOR_FK FOREIGN KEY (idEntrenador)
        REFERENCES ENTRENADORES (idEntrenador);

-- Crear tabla MANTENIMIENTOS
CREATE TABLE MANTENIMIENTOS (
    idMantenimiento VARCHAR2(10 CHAR) NOT NULL,
    fechaMantenimiento DATE NOT NULL,
    observacionesMantenimiento VARCHAR2(100 CHAR),
    idImplemento VARCHAR2(10 CHAR)NOT NULL,
    idTecnico VARCHAR2(10 CHAR) NOT NULL
);

ALTER TABLE MANTENIMIENTOS
    ADD CONSTRAINT MANTENIMIENTO_PK PRIMARY KEY (idMantenimiento);

ALTER TABLE MANTENIMIENTOS
    ADD CONSTRAINT MANTENIMIENTO_IMPLEMENTO_FK FOREIGN KEY (idImplemento)
        REFERENCES IMPLEMENTOS (idImplemento);

ALTER TABLE MANTENIMIENTOS
    ADD CONSTRAINT MANTENIMIENTO_TECNICO_FK FOREIGN KEY (idTecnico)
        REFERENCES TECNICOS (idTecnico);

-- Crear tabla ASISTENCIAS
CREATE TABLE ASISTENCIAS (
    idAsistencia VARCHAR2(10 CHAR) NOT NULL ,
    fechaAsistencia DATE NOT NULL,
    horaLlegada DATE NOT NULL,
    horaSalida DATE,
    idCliente VARCHAR2(10 CHAR) NOT NULL
);

ALTER TABLE ASISTENCIAS
    ADD CONSTRAINT ASISTENCIA_PK PRIMARY KEY (idAsistencia);

ALTER TABLE ASISTENCIAS
    ADD CONSTRAINT ASISTENCIA_CLIENTE_FK FOREIGN KEY (idCliente)
        REFERENCES CLIENTES (idCliente);
    
-- Crear tabla ACTIVACIONES_MENSUALES
CREATE TABLE ACTIVACIONES_MENSUALES (
    idActivacion VARCHAR2(10 CHAR) NOT NULL,
    idContrato VARCHAR2(10) NOT NULL,
    idPago VARCHAR2(10 CHAR) NOT NULL
);

ALTER TABLE ACTIVACIONES_MENSUALES
    ADD CONSTRAINT ACTIVACION_MENSUAL_PK PRIMARY KEY (idActivacion);

ALTER TABLE ACTIVACIONES_MENSUALES
    ADD CONSTRAINT ACTIVACION_MENSUAL_CONTRATO_FK FOREIGN KEY (idContrato)
        REFERENCES CONTRATOS (idContrato);

ALTER TABLE ACTIVACIONES_MENSUALES
    ADD CONSTRAINT ACTIVACION_MENSUAL_PAGO_MEMBRESIA_FK FOREIGN KEY (idPago)
        REFERENCES PAGOS_MEMBRESIA (idPago);

-- Inserción de Datos
-- DML:
-- CLIENTES
INSERT INTO CLIENTES VALUES ('CLI001', 'María González', '5551234567', 'maria.g@email.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('CLI002', 'Carlos Mendoza', '5552345678', 'carlos.m@email.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('CLI003', 'Ana López', '5553456789', 'ana.l@email.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('CLI004', 'Jorge Ramírez', '5554567890', 'jorge.r@email.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('CLI005', 'Luisa Fernández', '5555678901', 'luisa.f@email.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('CLI006', 'Juliana Martinez', '5553214567', 'juliii@email.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('CLI007', 'Andres Rodriguez', '5552344578', 'andrrz@email.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('CLI008', 'Marta Castillo', '5553458369', 'macar@email.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('CLI009', 'Felipe Ñandu', '5554456789', 'felipee.ñ@email.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('CLI010', 'Salome Fernández', '5555633301', 'soe@email.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('C001', 'Cliente1', '3100000001', 'cliente1@mail.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('C002', 'Cliente2', '3100000002', 'cliente2@mail.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('C003', 'Cliente3', '3100000003', 'cliente3@mail.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('C004', 'Cliente4', '3100000004', 'cliente4@mail.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('C005', 'Cliente5', '3100000005', 'cliente5@mail.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('C006', 'Cliente6', '3100000006', 'cliente6@mail.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('C007', 'Cliente7', '3100000007', 'cliente7@mail.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('C008', 'Cliente8', '3100000008', 'cliente8@mail.com', 'MASCULINO');
INSERT INTO CLIENTES VALUES ('C009', 'Cliente9', '3100000009', 'cliente9@mail.com', 'FEMENINO');
INSERT INTO CLIENTES VALUES ('C010', 'Cliente10', '3100000010', 'cliente10@mail.com', 'MASCULINO');

-- PROVEEDORES
INSERT INTO PROVEEDORES VALUES ('PROV001', '30 días neto', '5559876543', 'contacto@suplementos.com');
INSERT INTO PROVEEDORES VALUES ('PROV002', 'Pago contra entrega', '5558765432', 'ventas@equiposgym.com');
INSERT INTO PROVEEDORES VALUES ('PROV003', '15 días neto', '5557654321', 'info@bebidasenergia.com');
INSERT INTO PROVEEDORES VALUES ('P001', 'Crédito', '3159999001', 'proveedor1@mail.com');
INSERT INTO PROVEEDORES VALUES ('P002', 'Contado', '3159999002', 'proveedor2@mail.com');
INSERT INTO PROVEEDORES VALUES ('P003', 'Crédito', '3159999003', 'proveedor3@mail.com');
INSERT INTO PROVEEDORES VALUES ('P004', 'Contado', '3159999004', 'proveedor4@mail.com');
INSERT INTO PROVEEDORES VALUES ('P005', 'Crédito', '3159999005', 'proveedor5@mail.com');
INSERT INTO PROVEEDORES VALUES ('P006', 'Contado', '3159999006', 'proveedor6@mail.com');
INSERT INTO PROVEEDORES VALUES ('P007', 'Crédito', '3159999007', 'proveedor7@mail.com');
INSERT INTO PROVEEDORES VALUES ('P008', 'Contado', '3159999008', 'proveedor8@mail.com');
INSERT INTO PROVEEDORES VALUES ('P009', 'Crédito', '3159999009', 'proveedor9@mail.com');
INSERT INTO PROVEEDORES VALUES ('P010', 'Contado', '3159999010', 'proveedor10@mail.com');
INSERT INTO PROVEEDORES VALUES ('P011', 'Crédito', '3159999011', 'proveedor11@mail.com');
INSERT INTO PROVEEDORES VALUES ('P012', 'Contado', '3159999012', 'proveedor12@mail.com');
INSERT INTO PROVEEDORES VALUES ('P013', 'Crédito', '3159999013', 'proveedor13@mail.com');
INSERT INTO PROVEEDORES VALUES ('P014', 'Contado', '3159999014', 'proveedor14@mail.com');
INSERT INTO PROVEEDORES VALUES ('P015', 'Crédito', '3159999015', 'proveedor15@mail.com');
INSERT INTO PROVEEDORES VALUES ('P016', 'Contado', '3159999016', 'proveedor16@mail.com');
INSERT INTO PROVEEDORES VALUES ('P017', 'Crédito', '3159999017', 'proveedor17@mail.com');

-- PRODUCTOS

INSERT INTO PRODUCTOS VALUES ('PR001', 2000, 'Producto1', 11, 'Marca1', 'Desc1');
INSERT INTO PRODUCTOS VALUES ('PR002', 3000, 'Producto2', 12, 'Marca2', 'Desc2');
INSERT INTO PRODUCTOS VALUES ('PR003', 4000, 'Producto3', 13, 'Marca3', 'Desc3');
INSERT INTO PRODUCTOS VALUES ('PR004', 5000, 'Producto4', 14, 'Marca4', 'Desc4');
INSERT INTO PRODUCTOS VALUES ('PR005', 6000, 'Producto5', 15, 'Marca0', 'Desc5');
INSERT INTO PRODUCTOS VALUES ('PR006', 7000, 'Producto6', 16, 'Marca1', 'Desc6');
INSERT INTO PRODUCTOS VALUES ('PR007', 8000, 'Producto7', 17, 'Marca2', 'Desc7');
INSERT INTO PRODUCTOS VALUES ('PR008', 9000, 'Producto8', 18, 'Marca3', 'Desc8');
INSERT INTO PRODUCTOS VALUES ('PR009', 10000, 'Producto9', 19, 'Marca4', 'Desc9');
INSERT INTO PRODUCTOS VALUES ('PR011', 12000, 'Producto11', 21, 'Marca1', 'Desc1');
INSERT INTO PRODUCTOS VALUES ('PR012', 13000, 'Producto12', 22, 'Marca2', 'Desc2');
INSERT INTO PRODUCTOS VALUES ('PR013', 14000, 'Producto13', 23, 'Marca3', 'Desc3');
INSERT INTO PRODUCTOS VALUES ('PR014', 15000, 'Producto14', 24, 'Marca4', 'Desc4');
INSERT INTO PRODUCTOS VALUES ('PR015', 16000, 'Producto15', 25, 'Marca0', 'Desc5');
INSERT INTO PRODUCTOS VALUES ('PR016', 17000, 'Producto16', 26, 'Marca1', 'Desc6');

-- HORARIOS_RECEPCIONISTAS
INSERT INTO HORARIOS_RECEPCIONISTAS VALUES ('H001','05:00','13:00');
INSERT INTO HORARIOS_RECEPCIONISTAS VALUES ('H002','13:00','21:00');
INSERT INTO HORARIOS_RECEPCIONISTAS VALUES ('H003','21:00','05:00');

-- RECEPCIONISTAS
INSERT INTO RECEPCIONISTAS VALUES ('REC001', 'Sofía Jiménez', 'H001' , 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('REC002', 'Pedro Vargas', 'H001', 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('REC003', 'Matias Vasquez', 'H001', 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('R001', 'Recepcionista1', 'H001', 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('R002', 'Recepcionista2', 'H002', 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('R003', 'Recepcionista3', 'H002', 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('R004', 'Recepcionista4', 'H002', 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('R005', 'Recepcionista5', 'H002', 164750000);
INSERT INTO RECEPCIONISTAS VALUES ('R006', 'Recepcionista6', 'H003', 184750000);
INSERT INTO RECEPCIONISTAS VALUES ('R007', 'Recepcionista7', 'H003', 184750000);

-- ENTRENADORES
INSERT INTO ENTRENADORES VALUES ('ENT001', 'Roberto Castro', 5, 50000);
INSERT INTO ENTRENADORES VALUES ('ENT002', 'Laura Méndez', 4.4, 60000);
INSERT INTO ENTRENADORES VALUES ('ENT003', 'Miguel Ángel Soto', 4.3, 55000);
INSERT INTO ENTRENADORES VALUES ('E001', 'Entrenador1', 5, 86000);
INSERT INTO ENTRENADORES VALUES ('E002', 'Entrenador2', 5, 88000);
INSERT INTO ENTRENADORES VALUES ('E003', 'Entrenador3', 3, 56000);
INSERT INTO ENTRENADORES VALUES ('E004', 'Entrenador4', 4, 23000);
INSERT INTO ENTRENADORES VALUES ('E005', 'Entrenador5', 5, 79000);
INSERT INTO ENTRENADORES VALUES ('E006', 'Entrenador6', 3, 35000);
INSERT INTO ENTRENADORES VALUES ('E007', 'Entrenador7', 3, 91000);
INSERT INTO ENTRENADORES VALUES ('E008', 'Entrenador8', 4, 62000);
INSERT INTO ENTRENADORES VALUES ('E009', 'Entrenador9', 5, 51000);
INSERT INTO ENTRENADORES VALUES ('E010', 'Entrenador10', 4, 26000);
INSERT INTO ENTRENADORES VALUES ('E011', 'Entrenador11', 3, 56000);
INSERT INTO ENTRENADORES VALUES ('E012', 'Entrenador12', 4, 90000);

-- TECNICOS
INSERT INTO TECNICOS VALUES ('TEC001', 'Juan Pérez', 15000, 'titulo00.pdf', '5551112233');
INSERT INTO TECNICOS VALUES ('TEC002', 'Ana Ruiz', 18000, 'titulo01.pdf', '5552223344');
INSERT INTO TECNICOS VALUES ('T001', 'Tecnico1', 59000, 'titulo1.pdf', '3001234001');
INSERT INTO TECNICOS VALUES ('T002', 'Tecnico2', 55000, 'titulo2.pdf', '3001234002');
INSERT INTO TECNICOS VALUES ('T003', 'Tecnico3', 71000, 'titulo3.pdf', '3001234003');
INSERT INTO TECNICOS VALUES ('T004', 'Tecnico4', 45000, 'titulo4.pdf', '3001234004');
INSERT INTO TECNICOS VALUES ('T005', 'Tecnico5', 53000, 'titulo5.pdf', '3001234005');
INSERT INTO TECNICOS VALUES ('T006', 'Tecnico6', 31000, 'titulo6.pdf', '3001234006');
INSERT INTO TECNICOS VALUES ('T007', 'Tecnico7', 50000, 'titulo7.pdf', '3001234007');

-- PLANES_ENTRENAMIENTO
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PLAN001', 'Pérdida de peso', 12 , 150000, '3 sesiones semanales');
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PLAN002', 'Ganancia muscular', 12, 200000, '4 sesiones semanales');
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PLAN003', 'Mantenimiento', 6, 100000, '2 sesiones semanales');
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PL001', 'Objetivo 1', 5, 50000, 'Observacion 1');
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PL002', 'Objetivo 2', 8, 80000, 'Observacion 2');
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PL003', 'Objetivo 3', 8, 80000, 'Observacion 3');
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PL004', 'Objetivo 4', 8, 80000, 'Observacion 4');
INSERT INTO PLANES_ENTRENAMIENTO VALUES ('PL005', 'Objetivo 5', 7, 70000, 'Observacion 5');

-- IMPLEMENTOS
INSERT INTO IMPLEMENTOS VALUES ('I001', 'Implemento1', TO_DATE('2024-01-02', 'YYYY-MM-DD'), NULL);
INSERT INTO IMPLEMENTOS VALUES ('I002', 'Implemento2', TO_DATE('2024-01-03', 'YYYY-MM-DD'), TO_DATE('2024-07-01', 'YYYY-MM-DD'));
INSERT INTO IMPLEMENTOS VALUES ('I003', 'Implemento3', TO_DATE('2024-01-04', 'YYYY-MM-DD'), TO_DATE('2024-07-02', 'YYYY-MM-DD'));
INSERT INTO IMPLEMENTOS VALUES ('I004', 'Implemento4', TO_DATE('2024-01-05', 'YYYY-MM-DD'), TO_DATE('2024-07-03', 'YYYY-MM-DD'));
INSERT INTO IMPLEMENTOS VALUES ('I005', 'Implemento5', TO_DATE('2024-01-06', 'YYYY-MM-DD'), NULL);
INSERT INTO IMPLEMENTOS VALUES ('I006', 'Implemento6', TO_DATE('2024-01-07', 'YYYY-MM-DD'), NULL);
INSERT INTO IMPLEMENTOS VALUES ('I007', 'Implemento7', TO_DATE('2024-01-08', 'YYYY-MM-DD'), NULL);
INSERT INTO IMPLEMENTOS VALUES ('I008', 'Implemento8', TO_DATE('2024-01-09', 'YYYY-MM-DD'), NULL);
INSERT INTO IMPLEMENTOS VALUES ('I009', 'Implemento9', TO_DATE('2024-01-10', 'YYYY-MM-DD'), TO_DATE('2024-07-08', 'YYYY-MM-DD'));
INSERT INTO IMPLEMENTOS VALUES ('I010', 'Implemento10', TO_DATE('2024-01-11', 'YYYY-MM-DD'), TO_DATE('2024-07-09', 'YYYY-MM-DD'));
INSERT INTO IMPLEMENTOS VALUES ('I011', 'Implemento11', TO_DATE('2024-01-12', 'YYYY-MM-DD'), TO_DATE('2024-07-10', 'YYYY-MM-DD'));
INSERT INTO IMPLEMENTOS VALUES ('I012', 'Implemento12', TO_DATE('2024-01-13', 'YYYY-MM-DD'), TO_DATE('2024-07-11', 'YYYY-MM-DD'));
INSERT INTO IMPLEMENTOS VALUES ('I013', 'Implemento13', TO_DATE('2024-01-14', 'YYYY-MM-DD'), NULL);
INSERT INTO IMPLEMENTOS VALUES ('I014', 'Implemento14', TO_DATE('2024-01-15', 'YYYY-MM-DD'), NULL);
INSERT INTO IMPLEMENTOS VALUES ('I015', 'Implemento15', TO_DATE('2024-01-16', 'YYYY-MM-DD'), TO_DATE('2024-07-14', 'YYYY-MM-DD'));



-- PEDIDOS
INSERT INTO PEDIDOS VALUES ('PED001', TO_DATE('10/01/2023', 'DD/MM/YYYY'), 'RECIBIDO', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 'PROV001');
INSERT INTO PEDIDOS VALUES ('PED002', TO_DATE('05/02/2023', 'DD/MM/YYYY'), 'SOLICITADO', NULL, 'PROV002');
INSERT INTO PEDIDOS VALUES ('PE001', TO_DATE('2024-01-02', 'YYYY-MM-DD'), 'SOLICITADO', NULL, 'P002');
INSERT INTO PEDIDOS VALUES ('PE002', TO_DATE('2024-01-03', 'YYYY-MM-DD'), 'EN CAMINO', NULL, 'P003');
INSERT INTO PEDIDOS VALUES ('PE003', TO_DATE('2024-01-04', 'YYYY-MM-DD'), 'RECIBIDO', TO_DATE('2024-01-11', 'YYYY-MM-DD'), 'P004');

-- VENTAS
INSERT INTO VENTAS VALUES ('V001', TO_DATE('10/01/2023', 'DD/MM/YYYY'), 'CLI001', 'REC001');
INSERT INTO VENTAS VALUES ('V002', TO_DATE('10/02/2024', 'DD/MM/YYYY'), 'CLI003', 'REC002');
INSERT INTO VENTAS VALUES ('V003', TO_DATE('10/03/2024', 'DD/MM/YYYY'), 'C002', 'R002');
INSERT INTO VENTAS VALUES ('V004', TO_DATE('10/04/2024', 'DD/MM/YYYY'), 'C003', 'R003');
INSERT INTO VENTAS VALUES ('V005', TO_DATE('10/05/2024', 'DD/MM/YYYY'), 'C004', 'R004');
INSERT INTO VENTAS VALUES ('V006', TO_DATE('10/01/2023', 'DD/MM/YYYY'), 'CLI001', 'REC003');
INSERT INTO VENTAS VALUES ('V007', TO_DATE('10/02/2024', 'DD/MM/YYYY'), 'CLI003', 'REC002');
INSERT INTO VENTAS VALUES ('V008', TO_DATE('10/03/2024', 'DD/MM/YYYY'), 'C002', 'R001');
INSERT INTO VENTAS VALUES ('V009', TO_DATE('10/04/2024', 'DD/MM/YYYY'), 'C003', 'R003');
INSERT INTO VENTAS VALUES ('V0010', TO_DATE('10/05/2024', 'DD/MM/YYYY'), 'C004', 'R004');
INSERT INTO VENTAS VALUES ('V0011', TO_DATE('10/01/2023', 'DD/MM/YYYY'), 'CLI001', 'REC001');
INSERT INTO VENTAS VALUES ('V0012', TO_DATE('10/02/2024', 'DD/MM/YYYY'), 'CLI003', 'REC003');
INSERT INTO VENTAS VALUES ('V0013', TO_DATE('10/03/2024', 'DD/MM/YYYY'), 'C002', 'R002');
INSERT INTO VENTAS VALUES ('V0014', TO_DATE('10/04/2024', 'DD/MM/YYYY'), 'C003', 'R003');
INSERT INTO VENTAS VALUES ('V0015', TO_DATE('10/05/2024', 'DD/MM/YYYY'), 'C004', 'R004');
INSERT INTO VENTAS VALUES ('V0016', TO_DATE('10/01/2023', 'DD/MM/YYYY'), 'CLI001', 'REC001');
INSERT INTO VENTAS VALUES ('V0017', TO_DATE('10/02/2024', 'DD/MM/YYYY'), 'CLI003', 'REC003');
INSERT INTO VENTAS VALUES ('V0018', TO_DATE('10/03/2024', 'DD/MM/YYYY'), 'C002', 'R002');
INSERT INTO VENTAS VALUES ('V0019', TO_DATE('10/04/2024', 'DD/MM/YYYY'), 'C003', 'R003');
INSERT INTO VENTAS VALUES ('V0020', TO_DATE('10/05/2024', 'DD/MM/YYYY'), 'C004', 'R004');
INSERT INTO VENTAS VALUES ('V0021', TO_DATE('10/01/2023', 'DD/MM/YYYY'), 'CLI001', 'REC001');
INSERT INTO VENTAS VALUES ('V0022', TO_DATE('10/02/2024', 'DD/MM/YYYY'), 'CLI003', 'REC002');
INSERT INTO VENTAS VALUES ('V0023', TO_DATE('10/03/2024', 'DD/MM/YYYY'), 'C002', 'R005');
INSERT INTO VENTAS VALUES ('V0024', TO_DATE('10/04/2024', 'DD/MM/YYYY'), 'C003', 'R006');
INSERT INTO VENTAS VALUES ('V0025', TO_DATE('10/05/2024', 'DD/MM/YYYY'), 'C004', 'R007');

-- Productos Vendidos
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV001', 'V001', 2, 'PR001');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV002', 'V002', 3, 'PR002');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV003', 'V003', 4, 'PR003');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV004', 'V004', 2, 'PR004');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV005', 'V005', 3, 'PR005');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV006', 'V006', 4, 'PR006');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV007', 'V007', 2, 'PR007');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV008', 'V008', 3, 'PR008');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV009', 'V009', 4, 'PR009');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV011', 'V0011', 3, 'PR011');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV012', 'V0012', 4, 'PR012');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV013', 'V0013', 2, 'PR013');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV014', 'V0014', 3, 'PR013');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV015', 'V0015', 4, 'PR014');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV016', 'V0016', 2, 'PR015');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV017', 'V0017', 3, 'PR001');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV018', 'V0018', 4, 'PR002');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV019', 'V0019', 2, 'PR003');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV020', 'V0020', 3, 'PR004');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV021', 'V0021', 4, 'PR005');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV022', 'V0022', 2, 'PR006');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV023', 'V0023', 3, 'PR007');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV024', 'V0024', 4, 'PR008');
INSERT INTO PRODUCTOS_VENDIDOS VALUES ('PV025', 'V0025', 4, 'PR009');

-- PRODUCTOS_SURTIDOS
INSERT INTO PRODUCTOS_SURTIDOS VALUES ('SUR001', 20, 'PR001', 'PED001');
INSERT INTO PRODUCTOS_SURTIDOS VALUES ('SUR002', 50, 'PR003', 'PED002');
INSERT INTO PRODUCTOS_SURTIDOS VALUES ('SUR003', 20, 'PR001', 'PE001');
INSERT INTO PRODUCTOS_SURTIDOS VALUES ('SUR004', 50, 'PR003', 'PE002');
INSERT INTO PRODUCTOS_SURTIDOS VALUES ('SUR005', 20, 'PR001', 'PE003');


-- EVALUACIONES_FISICAS
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL001', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 68.5, 165, 25.2, 22.5, 'Buen estado físico', 'CLI001', 'ENT001');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL002', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 65, 165, 25.2, 22.5, 'Buen estado físico', 'CLI001', 'ENT001');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL003', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 70, 180, 24.5, 26.5, 'Mejorar Resistencia', 'CLI002', 'ENT002');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL004', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 70, 180, 24.5, 26.5, 'Se mantuvo', 'CLI002', 'ENT002');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL0004', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 50, 150, 19.5, 23.5, 'Mejorar Resistencia', 'CLI003', 'ENT003');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL005', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 50, 150, 18.5, 22.5, 'Se mantuvo', 'CLI003', 'ENT003');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL006', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 75, 175, 24.5, 21.0, 'Buen estado físico', 'CLI004', 'ENT001');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL007', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 74, 175, 24.2, 20.5, 'Se mantuvo', 'CLI004', 'ENT001');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL008', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 62, 160, 24.2, 22.0, 'Mejorar resistencia', 'CLI005', 'ENT002');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL009', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 62, 160, 24.2, 22.0, 'Se mantuvo', 'CLI005', 'ENT002');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL010', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 58, 158, 23.2, 21.5, 'Buen estado físico', 'CLI006', 'ENT003');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL011', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 57, 158, 22.8, 21.0, 'Se mantuvo', 'CLI006', 'ENT003');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL012', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 80, 180, 24.7, 25.0, 'Mejorar resistencia', 'CLI007', 'ENT001');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL013', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 79, 180, 24.4, 24.0, 'Se mantuvo', 'CLI007', 'ENT001');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL014', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 63, 165, 23.1, 22.5, 'Buen estado físico', 'CLI008', 'ENT002');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL015', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 62, 165, 22.8, 22.0, 'Se mantuvo', 'CLI008', 'ENT002');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL016', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 76, 178, 24.0, 23.5, 'Buen estado físico', 'CLI009', 'ENT003');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL017', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 75, 178, 23.7, 23.0, 'Se mantuvo', 'CLI009', 'ENT003');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL018', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 60, 160, 23.4, 21.0, 'Buen estado físico', 'CLI010', 'ENT001');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL019', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 59, 160, 23.0, 20.5, 'Se mantuvo', 'CLI010', 'ENT001');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL020', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 70, 170, 24.2, 22.0, 'Buen estado físico', 'C001', 'E001');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL021', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 69, 170, 23.9, 21.5, 'Se mantuvo', 'C001', 'E001');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL022', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 68, 175, 22.2, 20.0, 'Mejorar resistencia', 'C002', 'E002');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL023', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 67, 175, 21.9, 19.5, 'Se mantuvo', 'C002', 'E002');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL024', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 55, 160, 21.5, 21.0, 'Buen estado físico', 'C003', 'E003');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL025', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 54, 160, 21.1, 20.5, 'Se mantuvo', 'C003', 'E003');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL026', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 90, 185, 26.3, 25.0, 'Mejorar resistencia', 'C004', 'E004');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL027', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 88, 185, 25.7, 24.5, 'Se mantuvo', 'C004', 'E004');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL028', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 64, 168, 22.7, 20.5, 'Buen estado físico', 'C005', 'E005');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL029', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 63, 168, 22.3, 20.0, 'Se mantuvo', 'C005', 'E005');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL030', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 72, 175, 23.5, 22.0, 'Buen estado físico', 'C006', 'E006');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL031', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 71, 175, 23.2, 21.5, 'Se mantuvo', 'C006', 'E006');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL032', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 66, 166, 24.0, 21.5, 'Mejorar resistencia', 'C007', 'E007');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL033', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 65, 166, 23.6, 21.0, 'Se mantuvo', 'C007', 'E007');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL034', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 60, 162, 22.9, 20.5, 'Buen estado físico', 'C008', 'E008');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL035', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 59, 162, 22.5, 20.0, 'Se mantuvo', 'C008', 'E008');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL036', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 78, 180, 24.1, 23.0, 'Buen estado físico', 'C009', 'E009');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL037', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 77, 180, 23.8, 22.5, 'Se mantuvo', 'C009', 'E009');

INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL038', TO_DATE('15/01/2023', 'DD/MM/YYYY'), 59, 160, 23.0, 21.0, 'Buen estado físico', 'C010', 'E010');
INSERT INTO EVALUACIONES_FISICAS VALUES ('EVAL039', TO_DATE('15/02/2023', 'DD/MM/YYYY'), 58, 160, 22.7, 20.5, 'Se mantuvo', 'C010', 'E010');

-- MANTENIMIENTOS
INSERT INTO MANTENIMIENTOS VALUES ('MANT001', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I001', 'TEC001');
INSERT INTO MANTENIMIENTOS VALUES ('MANT002', TO_DATE('12/01/2023', 'DD/MM/YYYY'), 'Cambio de piezas gastadas', 'I002', 'TEC002');
INSERT INTO MANTENIMIENTOS VALUES ('MANT003', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I003', 'TEC001');
INSERT INTO MANTENIMIENTOS VALUES ('MANT004', TO_DATE('12/01/2023', 'DD/MM/YYYY'), 'Cambio de piezas gastadas', 'I004', 'TEC002');
INSERT INTO MANTENIMIENTOS VALUES ('MANT005', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I005', 'TEC001');
INSERT INTO MANTENIMIENTOS VALUES ('MANT006', TO_DATE('12/01/2023', 'DD/MM/YYYY'), 'Cambio de piezas gastadas', 'I006', 'TEC002');
INSERT INTO MANTENIMIENTOS VALUES ('MANT007', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I007', 'TEC001');
INSERT INTO MANTENIMIENTOS VALUES ('MANT008', TO_DATE('12/01/2023', 'DD/MM/YYYY'), 'Cambio de piezas gastadas', 'I008', 'TEC002');
INSERT INTO MANTENIMIENTOS VALUES ('MANT009', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I009', 'TEC001');
INSERT INTO MANTENIMIENTOS VALUES ('MANT010', TO_DATE('12/01/2023', 'DD/MM/YYYY'), 'Cambio de piezas gastadas', 'I010', 'TEC002');
INSERT INTO MANTENIMIENTOS VALUES ('MANT011', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I011', 'TEC001');
INSERT INTO MANTENIMIENTOS VALUES ('MANT012', TO_DATE('12/01/2023', 'DD/MM/YYYY'), 'Cambio de piezas gastadas', 'I012', 'TEC002');
INSERT INTO MANTENIMIENTOS VALUES ('MANT013', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I013', 'TEC001');
INSERT INTO MANTENIMIENTOS VALUES ('MANT014', TO_DATE('12/01/2023', 'DD/MM/YYYY'), 'Cambio de piezas gastadas', 'I014', 'TEC002');
INSERT INTO MANTENIMIENTOS VALUES ('MANT015', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 'Lubricación y ajuste', 'I015', 'TEC001');



-- ASISTENCIAS
INSERT INTO ASISTENCIAS VALUES ('ASIS001', TO_DATE('05/01/2023', 'DD/MM/YYYY'), TO_DATE('05/01/2023 09:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('05/01/2023 10:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI004');
INSERT INTO ASISTENCIAS VALUES ('ASIS002', TO_DATE('07/01/2023', 'DD/MM/YYYY'), TO_DATE('07/01/2023 14:15:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('07/01/2023 15:45:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI002');
INSERT INTO ASISTENCIAS VALUES ('ASIS003', TO_DATE('09/01/2023', 'DD/MM/YYYY'), TO_DATE('09/01/2023 08:45:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('09/01/2023 10:00:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI007');
INSERT INTO ASISTENCIAS VALUES ('ASIS004', TO_DATE('10/01/2023', 'DD/MM/YYYY'), TO_DATE('10/01/2023 10:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('10/01/2023 11:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI005');
INSERT INTO ASISTENCIAS VALUES ('ASIS005', TO_DATE('11/01/2023', 'DD/MM/YYYY'), TO_DATE('11/01/2023 13:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('11/01/2023 14:15:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI008');
INSERT INTO ASISTENCIAS VALUES ('ASIS006', TO_DATE('13/01/2023', 'DD/MM/YYYY'), TO_DATE('13/01/2023 16:30:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('13/01/2023 17:45:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI003');
INSERT INTO ASISTENCIAS VALUES ('ASIS007', TO_DATE('15/01/2023', 'DD/MM/YYYY'), TO_DATE('15/01/2023 07:30:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('15/01/2023 09:00:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI001');
INSERT INTO ASISTENCIAS VALUES ('ASIS008', TO_DATE('18/01/2023', 'DD/MM/YYYY'), TO_DATE('18/01/2023 12:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('18/01/2023 13:45:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI010');
INSERT INTO ASISTENCIAS VALUES ('ASIS009', TO_DATE('21/01/2023', 'DD/MM/YYYY'), TO_DATE('21/01/2023 10:15:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('21/01/2023 11:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI006');
INSERT INTO ASISTENCIAS VALUES ('ASIS010', TO_DATE('25/01/2023', 'DD/MM/YYYY'), TO_DATE('25/01/2023 15:30:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('25/01/2023 16:45:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI009');
INSERT INTO ASISTENCIAS VALUES ('ASIS011', TO_DATE('28/01/2023', 'DD/MM/YYYY'), TO_DATE('28/01/2023 08:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('28/01/2023 09:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI002');
INSERT INTO ASISTENCIAS VALUES ('ASIS012', TO_DATE('30/01/2023', 'DD/MM/YYYY'), TO_DATE('30/01/2023 17:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('30/01/2023 18:15:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI004');
INSERT INTO ASISTENCIAS VALUES ('ASIS013', TO_DATE('01/02/2023', 'DD/MM/YYYY'), TO_DATE('01/02/2023 09:45:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('01/02/2023 11:15:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI006');
INSERT INTO ASISTENCIAS VALUES ('ASIS014', TO_DATE('03/02/2023', 'DD/MM/YYYY'), TO_DATE('03/02/2023 13:30:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('03/02/2023 15:00:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI007');
INSERT INTO ASISTENCIAS VALUES ('ASIS015', TO_DATE('05/02/2023', 'DD/MM/YYYY'), TO_DATE('05/02/2023 11:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('05/02/2023 12:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI001');
INSERT INTO ASISTENCIAS VALUES ('ASIS016', TO_DATE('06/02/2023', 'DD/MM/YYYY'), TO_DATE('06/02/2023 10:30:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('06/02/2023 11:45:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI009');
INSERT INTO ASISTENCIAS VALUES ('ASIS017', TO_DATE('07/02/2023', 'DD/MM/YYYY'), TO_DATE('07/02/2023 16:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('07/02/2023 17:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI003');
INSERT INTO ASISTENCIAS VALUES ('ASIS018', TO_DATE('09/02/2023', 'DD/MM/YYYY'), TO_DATE('09/02/2023 14:00:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('09/02/2023 15:30:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI010');
INSERT INTO ASISTENCIAS VALUES ('ASIS019', TO_DATE('11/02/2023', 'DD/MM/YYYY'), TO_DATE('11/02/2023 08:15:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('11/02/2023 09:45:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI008');
INSERT INTO ASISTENCIAS VALUES ('ASIS020', TO_DATE('13/02/2023', 'DD/MM/YYYY'), TO_DATE('13/02/2023 09:30:00', 'DD/MM/YYYY HH24:MI:SS'), TO_DATE('13/02/2023 10:45:00', 'DD/MM/YYYY HH24:MI:SS'), 'CLI005');



-- ACTIVACIONES_MENSUALES
INSERT INTO ACTIVACIONES_MENSUALES VALUES ('ACT001', 'CONT001', 'PAG001');
INSERT INTO ACTIVACIONES_MENSUALES VALUES ('ACT002', 'CONT002', 'PAG002');
-- PAGOS_MEMBRESIA
INSERT INTO PAGOS_MEMBRESIA VALUES ('PAG001', TO_DATE('05/01/2023', 'DD/MM/YYYY'), 150, 'Completo', 'Tarjeta');
INSERT INTO PAGOS_MEMBRESIA VALUES ('PAG002', TO_DATE('10/01/2023', 'DD/MM/YYYY'), 200, 'Completo', 'Efectivo');

-- CONTRATOS
-- Supongamos que los planes tienen estas duraciones:
-- PL001: 1 mes, PL002: 2 meses, PL003: 3 meses, PL004: 4 meses, PL005: 5 meses

-- CLI001
INSERT INTO CONTRATOS VALUES ('CON001', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI001', 'PL001');

-- CLI002
INSERT INTO CONTRATOS VALUES ('CON002', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI002', 'PL002');

-- CLI003
INSERT INTO CONTRATOS VALUES ('CON003', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI003', 'PL003');

-- CLI004
INSERT INTO CONTRATOS VALUES ('CON004', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI004', 'PL004');

-- CLI005
INSERT INTO CONTRATOS VALUES ('CON005', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI005', 'PL005');

-- CLI006
INSERT INTO CONTRATOS VALUES ('CON006', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI006', 'PL001');

-- CLI007
INSERT INTO CONTRATOS VALUES ('CON007', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI007', 'PL002');

-- CLI008
INSERT INTO CONTRATOS VALUES ('CON008', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI008', 'PL003');

-- CLI009
INSERT INTO CONTRATOS VALUES ('CON009', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI009', 'PL004');

-- CLI010
INSERT INTO CONTRATOS VALUES ('CON010', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'CLI010', 'PL005');

-- C001
INSERT INTO CONTRATOS VALUES ('CON011', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C001', 'PL001');

-- C002
INSERT INTO CONTRATOS VALUES ('CON012', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C002', 'PL002');

-- C003
INSERT INTO CONTRATOS VALUES ('CON013', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C003', 'PL003');

-- C004
INSERT INTO CONTRATOS VALUES ('CON014', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C004', 'PL004');

-- C005
INSERT INTO CONTRATOS VALUES ('CON015', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C005', 'PL005');

-- C006
INSERT INTO CONTRATOS VALUES ('CON016', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C006', 'PL001');

-- C007
INSERT INTO CONTRATOS VALUES ('CON017', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C007', 'PL002');

-- C008
INSERT INTO CONTRATOS VALUES ('CON018', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C008', 'PL003');

-- C009
INSERT INTO CONTRATOS VALUES ('CON019', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C009', 'PL004');

-- C010
INSERT INTO CONTRATOS VALUES ('CON020', TO_DATE('01/01/2025', 'DD/MM/YYYY'), ADD_MONTHS(TO_DATE('01/01/2025', 'DD/MM/YYYY'), 7), 'C010', 'PL005');



--2.Consultas:
-- Lista de clientes con membresía vigente, incluyendo su tipo de plan y fecha de vencimiento, incluyendo los días restantes
SELECT c.idCliente, c.nombreCliente, pe.objetivoPlan AS tipoPlan, ct.fechaCierre AS fechaVencimiento, (ct.fechaCierre - TRUNC(SYSDATE)) AS dias_restantes,
CASE
WHEN (ct.fechaCierre - TRUNC(SYSDATE)) <= 7 THEN 'Vence Pronto'
WHEN (ct.fechaCierre - TRUNC(SYSDATE)) <= 30 THEN 'Vence este Mes'
ELSE 'Vigente'
END AS estado_membresía
FROM CLIENTES c
JOIN CONTRATOS ct ON c.idCliente = ct.idCliente
JOIN PLANES_ENTRENAMIENTO pe ON ct.idPlan = pe.idPlan
WHERE TRUNC(SYSDATE) BETWEEN ct.fechaInicio AND ct.fechaCierre
ORDER BY dias_restantes ASC;

-- Registro de los implementos a los cuales no se les hace mantenimiento desde hace más de un mes incluyendo información del tiempo que llevan sin mantenimiento

SELECT i.idImplemento, i.nombreImplemento, MAX(m.fechaMantenimiento) AS ultima_fecha,
CASE
WHEN MAX(m.fechaMantenimiento) IS NULL THEN 'Nunca'
ELSE TO_CHAR(TRUNC(MONTHS_BETWEEN(SYSDATE, MAX(m.fechaMantenimiento)))) || ' meses'
END AS tiempo_sin_mantenimiento
FROM IMPLEMENTOS i
LEFT JOIN MANTENIMIENTOS m ON i.idImplemento = m.idImplemento
GROUP BY i.idImplemento, i.nombreImplemento
HAVING MAX(m.fechaMantenimiento) < ADD_MONTHS(SYSDATE, -1)
   OR MAX(m.fechaMantenimiento) IS NULL
ORDER BY NVL(MAX(m.fechaMantenimiento), TO_DATE('01-01-1900', 'DD-MM-YYYY'));


-- Recepcionista que más vende junto a su cantidad
SELECT r.idRecepcionista, r.nombreRecepcionista AS nombre_completo, COUNT(v.idVenta) AS total_ventas
FROM VENTAS v
JOIN RECEPCIONISTAS r ON v.idRecepcionista = r.idRecepcionista
GROUP BY r.idRecepcionista, r.nombreRecepcionista
ORDER BY total_ventas DESC
FETCH FIRST 1 ROWS ONLY;


-- Ingresos del último mes
SELECT SUM(p.precioProducto * pv.cantidadTotal) AS ingresos_ultimo_mes
FROM VENTAS v
JOIN PRODUCTOS_VENDIDOS pv ON v.idVenta = pv.idVenta
JOIN PRODUCTOS p ON pv.idProducto = p.idProducto
WHERE TO_DATE(v.fechaVenta, 'DD/MM/YYYY') >= ADD_MONTHS(TRUNC(SYSDATE, 'MM'), -1)
  AND TO_DATE(v.fechaVenta, 'DD/MM/YYYY') < TRUNC(SYSDATE, 'MM');

-- Lista los productos más vendidos en un período determinado, agrupados por categoría y cantidad total vendida. 

SELECT p.descripcionProducto AS categoria, p.nombreProducto AS producto, SUM(pv.cantidadTotal) AS cantidad_total_vendida, SUM(pv.cantidadTotal * p.precioProducto) AS ingresos_totales
FROM PRODUCTOS_VENDIDOS pv
JOIN PRODUCTOS p ON pv.idProducto = p.idProducto
JOIN VENTAS v ON pv.idVenta = v.idVenta
GROUP BY p.descripcionProducto, p.nombreProducto
ORDER BY cantidad_total_vendida DESC;


-- contabilizar las ventas realizadas por cada recepcionista junto con el precio total

SELECT r.idRecepcionista, r.nombreRecepcionista, COUNT(v.idVenta) AS cantidad_ventas, SUM(p.precioProducto * pv.cantidadTotal) AS total_ingresos
FROM RECEPCIONISTAS r
JOIN VENTAS v ON r.idRecepcionista = v.idRecepcionista
JOIN PRODUCTOS_VENDIDOS pv ON v.idVenta = pv.idVenta
JOIN PRODUCTOS p ON pv.idProducto = p.idProducto
GROUP BY r.idRecepcionista, r.nombreRecepcionista
ORDER BY total_ingresos DESC;


-- evolución del peso de cada cliente entre su primera y última evaluación física
WITH EvaluacionesOrdenadas AS (
SELECT ef.idCliente, c.nombreCliente, ef.fechaEvaluacion, ef.peso, ROW_NUMBER() OVER (PARTITION BY ef.idCliente ORDER BY ef.fechaEvaluacion ASC) AS primera_evaluacion, ROW_NUMBER() OVER (PARTITION BY ef.idCliente ORDER BY ef.fechaEvaluacion DESC) AS ultima_evaluacion
FROM EVALUACIONES_FISICAS ef
JOIN CLIENTES c ON ef.idCliente = c.idCliente
)
SELECT e1.idCliente, e1.nombreCliente, e1.fechaEvaluacion AS fecha_primera_evaluacion, e1.peso AS peso_inicial, e2.fechaEvaluacion AS fecha_ultima_evaluacion, e2.peso AS peso_final, ROUND(e2.peso - e1.peso, 2) AS cambio_peso,
CASE 
WHEN e2.peso - e1.peso > 0 THEN 'Aumento'
WHEN e2.peso - e1.peso < 0 THEN 'Disminución'
ELSE 'Sin cambio'
END AS tendencia
FROM EvaluacionesOrdenadas e1
JOIN EvaluacionesOrdenadas e2 ON e1.idCliente = e2.idCliente
WHERE e1.primera_evaluacion = 1 AND e2.ultima_evaluacion = 1
ORDER BY ABS(e2.peso - e1.peso) DESC;



-- PL_SQL_PROCEDIMIENTO_FUNCIÓN_TRIGGER

-- Trigger: tr_valida_pago_membresia
--Función: Valida que el monto del pago coincida con el costo del plan asociado al contrato antes de insertar una activación mensual.

CREATE OR REPLACE TRIGGER tr_valida_pago_membresia
BEFORE INSERT ON ACTIVACIONES_MENSUALES
FOR EACH ROW
DECLARE v_costo_plan NUMBER; v_valor_pago NUMBER;
BEGIN
-- Obtener el costo del plan del contrato
SELECT pe.costoPlan INTO v_costo_plan
FROM CONTRATOS c
JOIN PLANES_ENTRENAMIENTO pe ON c.idPlan = pe.idPlan
WHERE c.idContrato = :NEW.idContrato;

-- Obtener el valor del pago
SELECT valorPago INTO v_valor_pago
FROM PAGOS_MEMBRESIA
WHERE idPago = :NEW.idPago;

-- Validar que coincidan
IF v_valor_pago != v_costo_plan THEN
RAISE_APPLICATION_ERROR(-20001, 'El monto del pago ('||v_valor_pago||') no coincide con el costo del plan ('||v_costo_plan||')');
END IF;
EXCEPTION
WHEN NO_DATA_FOUND THEN
RAISE_APPLICATION_ERROR(-20002, 'No se encontró el contrato o el pago especificado');
END tr_valida_pago_membresia;
/


-- Función para Determinar si un Cliente tiene Contrato Activo

CREATE OR REPLACE FUNCTION fn_cliente_tiene_contrato_activo (
    p_id_cliente IN VARCHAR2
) RETURN VARCHAR2
IS
    v_contador NUMBER;
    v_resultado VARCHAR2(100);
BEGIN
    -- Verificar si el cliente existe
    SELECT COUNT(*) INTO v_contador
    FROM CLIENTES
    WHERE idCliente = p_id_cliente;

    IF v_contador = 0 THEN
        RETURN 'Cliente no existe';
    END IF;

    -- Contar contratos activos (donde SYSDATE está entre fechaInicio y fechaCierre)
    SELECT COUNT(*) INTO v_contador
    FROM CONTRATOS
    WHERE idCliente = p_id_cliente
    AND SYSDATE BETWEEN fechaInicio AND fechaCierre;

    -- Determinar el resultado
    IF v_contador > 0 THEN
        v_resultado := 'SI';
    ELSE
        -- Verificar si tiene contratos pero no activos
        SELECT COUNT(*) INTO v_contador
        FROM CONTRATOS
        WHERE idCliente = p_id_cliente;

        IF v_contador > 0 THEN
            v_resultado := 'NO (pero tiene contratos inactivos)';
        ELSE
            v_resultado := 'NO (sin contratos)';
        END IF;
    END IF;

    RETURN v_resultado;
EXCEPTION
    WHEN OTHERS THEN
        RETURN 'Error al verificar: ' || SQLERRM;
END fn_cliente_tiene_contrato_activo;
/

-- EJEMPLOS DE APLICACIÓN

-- Ejemplo 1: Verificar estado de un cliente
SELECT fn_cliente_tiene_contrato_activo('CLI001') AS estado_contrato FROM dual;

-- Ejemplo 2: Listar todos los clientes con su estado de contrato
SELECT idCliente, nombreCliente, fn_cliente_tiene_contrato_activo(idCliente) AS contrato_activo
FROM CLIENTES;

-- Procedimiento Almacenado: sp_activar_membresia
-- Función: Activa una membresía mensual creando registros en ACTIVACIONES_MENSUALES y PAGOS_MEMBRESIA para un contrato específico.

CREATE OR REPLACE PROCEDURE sp_activar_membresia (
    p_id_contrato IN VARCHAR2,
    p_metodo_pago IN VARCHAR2,
    p_resultado OUT VARCHAR2
)
IS
    v_id_pago VARCHAR2(10);
    v_id_activacion VARCHAR2(10);
    v_costo_plan NUMBER;
    v_contador NUMBER;
BEGIN
    -- Verificar si el contrato existe
    SELECT COUNT(*) INTO v_contador FROM CONTRATOS WHERE idContrato = p_id_contrato;

    IF v_contador = 0 THEN
        p_resultado := 'Error: El contrato no existe';
        RETURN;
    END IF;

    -- Obtener el costo del plan asociado al contrato
    SELECT pe.costoPlan INTO v_costo_plan
    FROM CONTRATOS c
    JOIN PLANES_ENTRENAMIENTO pe ON c.idPlan = pe.idPlan
    WHERE c.idContrato = p_id_contrato;

    -- Generar ID para el pago
    SELECT 'PAG'||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(idPago, 4))), 0)+1, 3, '0')
    INTO v_id_pago FROM PAGOS_MEMBRESIA;

    -- Insertar el pago
    INSERT INTO PAGOS_MEMBRESIA (idPago, fechaPago, valorPago, estadoPago, metodoPago)
    VALUES (v_id_pago, SYSDATE, v_costo_plan, 'Completo', p_metodo_pago);

    -- Generar ID para la activación
    SELECT 'ACT'||LPAD(NVL(MAX(TO_NUMBER(SUBSTR(idActivacion, 4))), 0)+1, 3, '0')
    INTO v_id_activacion FROM ACTIVACIONES_MENSUALES;

    -- Insertar la activación mensual
    INSERT INTO ACTIVACIONES_MENSUALES (idActivacion, idContrato, idPago)
    VALUES (v_id_activacion, p_id_contrato, v_id_pago);

    p_resultado := 'Membresía activada correctamente para el contrato '||p_id_contrato;

    COMMIT;
EXCEPTION
    WHEN OTHERS THEN
        ROLLBACK;
        p_resultado := 'Error al activar membresía: '||SQLERRM;
END sp_activar_membresia;
/

-- EJEMPLO DE APLICACION

DECLARE
    v_resultado VARCHAR2(200);
BEGIN
    sp_activar_membresia('CONT001', 'Tarjeta', v_resultado);
    DBMS_OUTPUT.PUT_LINE(v_resultado);
END;
/

